{% extends 'base.html' %}

{% block content %}
    <p>ISBN: {{book.isbn}}</p>
    <h2>{{book.title}}</h2>
    <img src={{book.image_url_m}} alt={{book.title}}>
    <h4>Written by {{book.author}}</h4>
    <p>Published in {{book.year_of_publish}}</p>

    <button id="like" onclick="like({{book.pk}})">Like</button>
    <table id ="likedBy">
    </table>
    <script>
        async function like(id){
            const formData = new FormData()
            formData.append("id", id)
            
            fetch("{% url 'main:add_like_ajax' %}", {
                method: "POST",
                body: formData
            })
            document.getElementById('like').style.color = "blue";
            
            var likes = await see_like(id)
            res = `<tr>
                <th>by</th>
                <th>book</th>
                </tr>`
                res+=`\n<tr>
                    <td>${l.fields.user}</td>
                    <td>${l.fields.book}</td>
                    <p>ANJING</p>
                </tr>` 
            })
            document.getElementById('likedBy').innerHTML =res
        }

        async function see_like(id){
            const formData= new FormData()
            formData.append("id", id)
            return fetch("{% url 'main:see_like_ajax' %}", {
                method: "POST",
                body: formData
            }).then((res) => res.json())
        }
    </script>
{%endblock%}